<% i18n_scope = [:views, :orders, :index] %>
<% title t(:title, scope: i18n_scope) %>
<h1><%= t(:title, scope: i18n_scope) %></h1>

<%= grid(@orders_grid) do |g|
  g.column name: 'Number', attribute: 'number' do |order|
    order.number
  end
  g.column name: 'Completion Date', attribute: 'completion_date' do |order|
    order.completion_date
  end
  g.column name: 'Status', attribute: 'status' do |order|
    order.status
  end
  g.column name: 'Name', attribute: 'last_name' do |order|
    order.name
  end
  g.column name: 'Telephone', attribute: 'telephone' do |order|
    order.telephone
  end
  g.column name: 'Email', attribute: 'email' do |order|
    order.email
  end
  g.column name: 'User', attribute: 'last_name' do |order|
    order.user.try(:name)
  end
  g.column do |order|
    link_to 'Edit', edit_order_path(order)
  end
  g.column do |order|
    link_to 'Delete', order, method: :delete, data: { confirm: 'Are you sure?' }
  end
end -%>

<table id='orders-table' class='table'>
  <thead>
    <tr>
      <th>Number</th>
      <th>Completion date</th>
      <th>Status</th>
      <th>First name</th>
      <th>Last name</th>
      <th>Telephone</th>
      <th>Email</th>
      <th>User</th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @orders.each do |order| %>
      <tr <%= 'class=info' if order.user == current_user %>>
        <td><%= order.number %></td>
        <td><%= order.completion_date %></td>
        <td><%= order.status %></td>
        <td><%= order.first_name %></td>
        <td><%= order.last_name %></td>
        <td><%= order.telephone %></td>
        <td><%= order.email %></td>
        <td><%= order.user.try(:name) %></td>
        <td class='td-button'>
          <div class='btn-group'>
            <%= link_to 'Edit', edit_order_path(order), role: 'button', class: 'btn btn-default' %>
            <button type='button' class='btn btn-default dropdown-toggle' data-toggle='dropdown' aria-expanded='false'>
              <span class='caret'></span>
            </button>
            <ul class='dropdown-menu' role='menu'>
              <li><%= link_to 'Delete', order, method: :delete, data: { confirm: 'Are you sure?' } %></li>
            </ul>
          </div>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>
